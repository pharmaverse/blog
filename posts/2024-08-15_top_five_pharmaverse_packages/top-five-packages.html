<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gift Kenneth">
<meta name="author" content="APPSILON">
<meta name="dcterms.date" content="2024-08-15">
<meta name="description" content="This blog explores the top 5 popular pharmaverse packages for clinical reporting featuring {rtables}, {admiral}, {teal}, {riskmetric}, and {tidyCDISC} for improving data analysis and to ensure compliance.">

<title>Exploring the Top 5 pharmaverse Packages – pharmaverse blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../media/pharmaverseblog.png" rel="icon" type="image/png">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6ZDR80SCKG"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6ZDR80SCKG', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<style>

      .quarto-title-block .quarto-title-banner {
        background: #eeeeee;
      }
</style>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Exploring the Top 5 pharmaverse Packages – pharmaverse blog">
<meta property="og:description" content="This blog explores the top 5 popular pharmaverse packages for clinical reporting featuring {rtables}, {admiral}, {teal}, {riskmetric}, and {tidyCDISC} for improving data analysis and to ensure compliance.">
<meta property="og:image" content="https://pharmaverse.github.io/blog/posts/2024-08-15_top_five_pharmaverse_packages/top-five-pharmaverse.png">
<meta property="og:site_name" content="pharmaverse blog">
<meta property="og:image:height" content="1081">
<meta property="og:image:width" content="1921">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">pharmaverse blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pharmaverse/blog"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../session_info.html"> 
<span class="menu-text">Session Info</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Exploring the Top 5 pharmaverse Packages</h1>
                  <div>
        <div class="description">
          This blog explores the top 5 popular pharmaverse packages for clinical reporting featuring {rtables}, {admiral}, {teal}, {riskmetric}, and {tidyCDISC} for improving data analysis and to ensure compliance.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Technical</div>
                <div class="quarto-category">Community</div>
                <div class="quarto-category">Shiny</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-contents">
               <p>Gift Kenneth </p>
               <p>APPSILON </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 15, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#rtables-crafting-regulatory-ready-tables" id="toc-rtables-crafting-regulatory-ready-tables" class="nav-link active" data-scroll-target="#rtables-crafting-regulatory-ready-tables"><strong>{rtables}: Crafting Regulatory-Ready Tables</strong></a>
  <ul class="collapse">
  <li><a href="#features-of-rtables" id="toc-features-of-rtables" class="nav-link" data-scroll-target="#features-of-rtables"><strong>Features of {rtables}</strong></a></li>
  <li><a href="#example-code" id="toc-example-code" class="nav-link" data-scroll-target="#example-code"><strong>Example Code</strong></a></li>
  </ul></li>
  <li><a href="#admiral-simplifying-adam-dataset-creation" id="toc-admiral-simplifying-adam-dataset-creation" class="nav-link" data-scroll-target="#admiral-simplifying-adam-dataset-creation"><strong>{admiral}: Simplifying ADaM Dataset Creation</strong></a>
  <ul class="collapse">
  <li><a href="#features-of-admiral" id="toc-features-of-admiral" class="nav-link" data-scroll-target="#features-of-admiral"><strong>Features of {admiral}</strong></a></li>
  <li><a href="#example-code-1" id="toc-example-code-1" class="nav-link" data-scroll-target="#example-code-1"><strong>Example Code</strong></a></li>
  </ul></li>
  <li><a href="#teal-interactive-data-exploration" id="toc-teal-interactive-data-exploration" class="nav-link" data-scroll-target="#teal-interactive-data-exploration"><strong>{teal}: Interactive Data Exploration</strong></a>
  <ul class="collapse">
  <li><a href="#features-of-teal" id="toc-features-of-teal" class="nav-link" data-scroll-target="#features-of-teal"><strong>Features of {teal}</strong></a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><strong>Example</strong></a></li>
  </ul></li>
  <li><a href="#riskmetric-assessing-package-quality-and-risk" id="toc-riskmetric-assessing-package-quality-and-risk" class="nav-link" data-scroll-target="#riskmetric-assessing-package-quality-and-risk"><strong>{riskmetric}: Assessing Package Quality and Risk</strong></a>
  <ul class="collapse">
  <li><a href="#features-of-riskmetric" id="toc-features-of-riskmetric" class="nav-link" data-scroll-target="#features-of-riskmetric"><strong>Features of {riskmetric}</strong></a></li>
  <li><a href="#example-code-2" id="toc-example-code-2" class="nav-link" data-scroll-target="#example-code-2"><strong>Example Code</strong></a></li>
  </ul></li>
  <li><a href="#tidycdisc-tidying-cdisc-data" id="toc-tidycdisc-tidying-cdisc-data" class="nav-link" data-scroll-target="#tidycdisc-tidying-cdisc-data"><strong>TidyCDISC: Tidying CDISC Data</strong></a>
  <ul class="collapse">
  <li><a href="#features-of-tidycdisc" id="toc-features-of-tidycdisc" class="nav-link" data-scroll-target="#features-of-tidycdisc"><strong>Features of TidyCDISC</strong></a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><strong>Example</strong></a></li>
  </ul></li>
  <li><a href="#honorable-mention" id="toc-honorable-mention" class="nav-link" data-scroll-target="#honorable-mention"><strong>Honorable Mention 😀</strong></a>
  <ul class="collapse">
  <li><a href="#xportr-creating-cdisc-compliant-xpt-files-in-r" id="toc-xportr-creating-cdisc-compliant-xpt-files-in-r" class="nav-link" data-scroll-target="#xportr-creating-cdisc-compliant-xpt-files-in-r"><strong>{xportr}: Creating CDISC-Compliant XPT Files in R</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>Conclusion</strong></a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<!--------------- typical setup ----------------->
<!--------------- post begins here ----------------->
<p>The <a href="https://pharmaverse.org/">pharmaverse</a> is a collaborative project where leading pharmaceutical companies and passionate individuals come together to create helpful tools for <a href="https://posit.co/blog/pharmaverse-packages-for-clinical-reporting-workflows/">clinical reporting</a>. By <strong>using R programming and the open-source community</strong>, the <a href="https://github.com/pharmaverse/">pharmaverse</a> makes it easier to gain insights and increase transparency in the pharma industry.</p>
<p>In this post, let’s explore the <strong>top 5 <a href="https://pharmaverse.org/">pharmaverse</a> packages</strong> (by GitHub Stars ⭐), their interesting features, and how they can be used in clinical data analysis and reporting.</p>
<section id="rtables-crafting-regulatory-ready-tables" class="level2">
<h2 class="anchored" data-anchor-id="rtables-crafting-regulatory-ready-tables"><strong>{rtables}: Crafting Regulatory-Ready Tables</strong></h2>
<p><img src="images/rtables.png" class="img-fluid" width="263"></p>
<p>Let’s start our journey with <a href="https://github.com/insightsengineering/rtables">{rtables}</a>, a package contributed by <a href="https://www.roche.com/">Roche</a>, which enables the creation of tables for reporting clinical trials. It offers a flexible and efficient way to generate publication-quality tables, simplifying the reporting process and ensuring consistency across different trials.</p>
<p><a href="https://github.com/insightsengineering/rtables">{rtables}</a> was primarily designed to address the needs of the pharmaceutical industry for creating regulatory-ready tables for clinical trial reporting. <strong>You can use it to generate tables to summarize patient demographics, adverse events, efficacy endpoints, and other clinical trial data.</strong></p>
<section id="features-of-rtables" class="level3">
<h3 class="anchored" data-anchor-id="features-of-rtables"><strong>Features of {rtables}</strong></h3>
<p>The <a href="https://github.com/insightsengineering/rtables">{rtables}</a> package offers several features that make it a useful tool for creating complex tables:</p>
<ul>
<li><p><a href="https://github.com/insightsengineering/rtables">{rtables}</a> allows you to define tables with a <strong>hierarchical, tree-like structure</strong>, enabling the creation of multi-level tables with nested rows and columns.</p></li>
<li><p>Each cell in an rtable can contain any high-dimensional data structure, and you can apply custom formatting, such as rounding, alignment, and cell spans, to individual cells.</p></li>
<li><p>It <strong>supports various output formats</strong>, including HTML, ASCII, LaTeX, and PDF, allowing you to generate tables that can be easily integrated into reports, presentations, and shiny applications.</p></li>
<li><p>The values in an rtable are <strong>stored in a non-rounded state</strong>, supporting cross-checking and further analysis.</p></li>
<li><p>This package is <strong>designed to work with CDISC standards</strong>, allowing you to seamlessly integrate it into your clinical data reporting workflows.</p></li>
</ul>
</section>
<section id="example-code" class="level3">
<h3 class="anchored" data-anchor-id="example-code"><strong>Example Code</strong></h3>
<p>The following example demonstrates how to create a basic table using the <a href="https://github.com/insightsengineering/rtables">{rtables}</a> package. We start by installing and loading the required libraries.&nbsp;</p>
<p>Next, we create a simulated dataset representing clinical trial data. We then define a function to calculate the mean of a biomarker and use <a href="https://github.com/insightsengineering/rtables">{rtables}</a> functions to build and print the table.</p>
<pre><code># Install rtables if it's not already installed
if (!requireNamespace("rtables", quietly = TRUE)) {
  install.packages("rtables")
}

# Load required library
library(rtables)

# Create a simulated dataset
set.seed(123)
ex_adsl &lt;- data.frame(
  ARM = sample(c("Placebo", "Drug X", "Combination"), 100, replace = TRUE),
  BMRKR2 = sample(c("Low", "Medium", "High"), 100, replace = TRUE),
  RACE = sample(c("Asian", "Black", "White"), 100, replace = TRUE),
  SEX = sample(c("Male", "Female"), 100, replace = TRUE),
  BMRKR1 = rnorm(100, mean = 5, sd = 2)
)

# Define a function to calculate the mean of a biomarker
biomarker_ave &lt;- function(x, ...) {
  val &lt;- if (length(x) &gt; 0) round(mean(x), 2) else "no data"
  in_rows("Biomarker 1 (mean)" = rcell(val))
}

# Create the table
table &lt;- basic_table() |&gt;
  split_cols_by("ARM") |&gt;
  split_cols_by("BMRKR2") |&gt;
  add_colcounts() |&gt;
  split_rows_by("RACE", split_fun = trim_levels_in_group("SEX")) |&gt;
  split_rows_by("SEX") |&gt;
  summarize_row_groups() |&gt;
  analyze("BMRKR1", biomarker_ave) |&gt;
  build_table(ex_adsl)

# Print the table
print(table)</code></pre>
<p><strong>Results</strong></p>
<p><img src="images/rtables-example.png" class="img-fluid"></p>
<p><strong>You can learn more about rtables:</strong></p>
<ul>
<li><p><a href="https://waddella.github.io/RStudioTableContest2020/A_Not_So_Short_Introduction_to_rtables.html">A Not So Short Introduction to rtables</a>&nbsp;</p></li>
<li><p><a href="https://insightsengineering.github.io/rtables/latest-release/articles/rtables.html?q=introduction">Introduction to {rtables}</a></p></li>
<li><p><a href="https://github.com/insightsengineering/rtables">GitHub - insightsengineering/rtables: Reporting tables with R</a>&nbsp;&nbsp;</p></li>
</ul>
</section>
</section>
<section id="admiral-simplifying-adam-dataset-creation" class="level2">
<h2 class="anchored" data-anchor-id="admiral-simplifying-adam-dataset-creation"><strong>{admiral}: Simplifying ADaM Dataset Creation</strong></h2>
<p><img src="images/admiral.png" class="img-fluid" width="260"></p>
<p>Next let’s take a look at the <a href="https://pharmaverse.github.io/admiral/"><strong>{admiral}</strong></a> package, initially developed through a collaboration between <a href="https://www.roche.com/">Roche</a> and <a href="https://www.gsk.com/en-gb/">GSK</a>. It provides a toolbox of reusable functions and utilities with <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a><strong>-like syntax</strong> to prepare <strong>CDISC ADaM (Analysis Data Model)</strong> <strong>datasets</strong>. It serves as a valuable resource for statistical programmers looking to build ADaMs according to varying analysis needs while ensuring traceability and compliance with <strong>FDA standards</strong>. Many more pharma companies and CROs have contributed to the package since its inception in 2021.</p>
<section id="features-of-admiral" class="level3">
<h3 class="anchored" data-anchor-id="features-of-admiral"><strong>Features of {admiral}</strong></h3>
<p>Let’s take a look at some features of the package:&nbsp;</p>
<ul>
<li><p><a href="https://github.com/pharmaverse/admiral/">{admiral}</a> offers <strong>modular functions</strong> for adding variables and records to datasets in a step-by-step manner. This makes it easy to adjust code by adding, removing, or modifying derivations.</p></li>
<li><p>It provides <strong>template R scripts as a starting point for creating different ADaM datasets.</strong> These templates can be generated using the use_ad_template() function.</p></li>
<li><p>The package offers a <strong>flexible and efficient way to generate ADaM datasets</strong> from source data, ensuring compliance with CDISC standards and traceability of the data transformation process.</p></li>
<li><p><strong>By providing a consistent set of functions and utilities</strong> for ADaM dataset creation, <a href="https://github.com/pharmaverse/admiral/">{admiral}</a> helps to standardize the reporting process across different clinical trials and pharmaceutical companies.</p></li>
<li><p><strong>Modular design allows for extensions</strong> that focus on specific areas or needs. Three open-source packages are currently extending {admiral}: <a href="https://github.com/pharmaverse/admiralonco">{admiralonco}</a>, <a href="https://github.com/pharmaverse/admiralophtha">{admiraloptha}</a> and <a href="https://github.com/pharmaverse/admiralvaccine">{admiralvaccine}</a>. All of them were created from the <a href="https://github.com/pharmaverse/admiraltemplate">admiral template</a>. Two more are in the works: <a href="https://github.com/pharmaverse/admiralpeds">{admiralpeds}</a> and <a href="https://github.com/pharmaverse/admiralmetabolic">{admiralmetabolic}</a>.</p></li>
</ul>
</section>
<section id="example-code-1" class="level3">
<h3 class="anchored" data-anchor-id="example-code-1"><strong>Example Code</strong></h3>
<p>Let’s see how to use the <a href="https://github.com/pharmaverse/admiral/">{admiral}</a> package to prepare an ADaM dataset.&nbsp;</p>
<p>We start by loading the necessary libraries and creating a sample study dataset. We then derive the ADSL (Subject-Level Analysis Dataset) and add additional variables for further analysis.</p>
<pre><code>library(admiral)
library(dplyr)
library(lubridate)

# Sample study data
study_data &lt;- tibble::tribble(
  ~USUBJID, ~AGE, ~SEX, ~ARM, ~RANDDTC, ~RAND2DTC, ~VISIT, ~VISITDY, ~VSDTC, ~VSTPT, ~VSORRESU, ~VSORRES, ~PARAMCD,
  "01", 34, "M", "Placebo", "2022-12-10", "2023-01-15", "Screening", -7, "2023-01-08", "Pre-dose", "kg", 80, "WEIGHT",
  "02", 45, "F", "Treatment", "2023-01-02", "2023-01-17", "Baseline", 1, "2023-01-17", "Pre-dose", "kg", 65, "WEIGHT",
  "03", 54, "F", "", "2022-10-16", "2023-01-09", "Screening", -7, "2023-01-09", "Pre-dose", "kg", 78, "WEIGHT"
)

# Function to aggregate by age group
format_agegr1 &lt;- function(var_input) {
  case_when(
    var_input &lt; 35 ~ "&lt;35",
    between(var_input, 34, 50) ~ "35-49",
    var_input &gt; 50 ~ "&gt;64",
    TRUE ~ "Missing"
  )
}

# Derive ADSL (Subject-Level Analysis Dataset)
adsl &lt;- study_data |&gt;
  select(USUBJID, AGE, SEX, ARM, RANDDTC, RAND2DTC) |&gt;
  distinct() |&gt;
  # Convert blanks strings to NA
  convert_blanks_to_na() |&gt;
  # admiral does not yet support aggregation function, but dplyr can be used
  mutate(
    AGEGR1 = format_agegr1(AGE)
  ) |&gt;
  # Convert from character to DATE
  derive_vars_dt(
    dtc = RANDDTC,
    new_vars_prefix = "TRTS"
  ) |&gt;
  derive_vars_dt(
    dtc = RAND2DTC,
    new_vars_prefix = "TRTE"
  ) |&gt;
  derive_vars_duration(
    new_var = TRTD,
    start_date = TRTSDT,
    end_date = TRTEDT,
    add_one = FALSE
  )

# Display the ADSL dataset
print(adsl)</code></pre>
<p><strong>Results</strong></p>
<p><img src="images/admiral-example.png" class="img-fluid"></p>
<p><strong>More on {admiral}:</strong></p>
<ul>
<li><p><a href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">{admiral} Cheatsheet</a></p></li>
<li><p><a href="https://youtu.be/YO0t8Ul9dEo?si=7hNC8GyuTYh0HWcL">YouTube playlist of {admiral} videos</a></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/admiral/readme/README.html">admiral</a>&nbsp;</p></li>
<li><p><a href="https://pharmaverse.github.io/admiral/articles/admiral.html#setup">Get Started • admiral</a>&nbsp;</p></li>
<li><p><a href="https://www.appsilon.com/post/exploring-clinical-submissions-with-admiral">Recap: Exploring Clinical Submissions with admiral: An R-Based ADaM Solution with Ben Straub</a>&nbsp;<br>
</p></li>
</ul>
</section>
</section>
<section id="teal-interactive-data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="teal-interactive-data-exploration"><strong>{teal}: Interactive Data Exploration</strong></h2>
<p><img src="images/teal.png" class="img-fluid" width="245"></p>
<p><a href="https://github.com/insightsengineering/teal"><strong>{teal}</strong></a> is an open-source R Shiny framework developed by <a href="https://www.roche.com/">Roche</a> that enables the creation of interactive data exploration applications for the pharmaceutical industry. <a href="https://insightsengineering.github.io/teal/latest-tag/">{teal}</a> is particularly well-suited for exploring and analyzing data from clinical trials, enabling researchers and clinicians to quickly identify trends, patterns, and insights.<br>
</p>
<p><a href="https://insightsengineering.github.io/teal/latest-tag/">{teal}</a>’s reporting functionality can be used to generate regulatory-ready tables, figures, and listings. Study teams currently use it to explore data interactively and get the code to reproduce those TLGs. In the future, we hope to use it for submission to governing bodies. It can also be used to <strong>build interactive dashboards for monitoring and analyzing adverse events in clinical trials, supporting pharmacovigilance efforts.</strong> Its modular design allows for the <strong>integration of specialized modules</strong> for the analysis and visualization of high-dimensional biomarker data.</p>
<section id="features-of-teal" class="level3">
<h3 class="anchored" data-anchor-id="features-of-teal"><strong>Features of {teal}</strong></h3>
<ul>
<li><p><a href="https://insightsengineering.github.io/teal/latest-tag/">{teal}</a> offers a <strong>flexible filter panel</strong> that allows users to easily filter and explore their data in real-time.</p></li>
<li><p>The <strong>“Show R Code” functionality</strong> enables users to reproduce the visualizations and analyses from the application in a new R session, promoting transparency and reproducibility.</p></li>
<li><p>Its <strong>reporter functionality</strong> allows users to <strong>build custom reports</strong> based on the visualizations filtered and parameterized in the app. Users can generate PDFs or PPT documents that include images and optional code.</p></li>
<li><p>The package is built on a <strong>modular architecture</strong>, providing a range of pre-built, customizable modules that can be easily integrated into applications to address specific data analysis and visualization needs.</p></li>
<li><p>It is designed to <strong>seamlessly integrate with other <a href="https://pharmaverse.org/">pharmaverse</a> packages</strong>, such as <a href="https://github.com/pharmaverse/admiral">{admiral}</a> and <a href="https://github.com/insightsengineering/rtables">{rtables}</a>.</p></li>
</ul>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example"><strong>Example</strong></h3>
<p>Here’s the <a href="https://github.com/insightsengineering/teal.gallery/tree/main/patient-profile">Patient Profile {teal} application</a> for patient-level analysis of clinical trial data from the <a href="https://insightsengineering.github.io/teal.gallery/">teal.gallery</a>.</p>
<p><img src="images/teal-example.gif" class="img-fluid"></p>
<p><strong>Here’s how you can run the app yourself:</strong></p>
<pre><code>source("https://raw.github.com/insightsengineering/teal.gallery/main/_internal/utils/sourceme.R")

# Run the app
restore_and_run("patient-profile", package_repo = "https://insightsengineering.r-universe.dev")</code></pre>
<p>You can also find the <a href="https://genentech.shinyapps.io/nest_patient-profile_stable/">deployed version of the application</a>.&nbsp;</p>
<p><strong>Some Resources on {teal}</strong></p>
<ul>
<li><p><a href="https://github.com/insightsengineering/teal.gallery">GitHub - Teal Gallery (A Gallery of Exploratory Web Apps used for Analyzing Clinical Trial Data)</a></p></li>
<li><p><a href="https://pharmaverse.github.io/blog/posts/2024-07-22_teal_app_development_pharmaverseadam/teal-app-development.html">Simplifying Clinical Data Dashboards with {teal} and {pharmaverseadam}</a></p></li>
<li><p><a href="https://github.com/insightsengineering/teal">GitHub - insightsengineering/teal: Exploratory Web Apps for Analyzing Clinical Trial Data</a>&nbsp;</p></li>
<li><p><a href="https://www.appsilon.com/post/innovating-pharma-with-teal">Shiny Gatherings #8: Teal’s Role in Pharma Innovation with Paweł Rucki</a>&nbsp;</p></li>
</ul>
</section>
</section>
<section id="riskmetric-assessing-package-quality-and-risk" class="level2">
<h2 class="anchored" data-anchor-id="riskmetric-assessing-package-quality-and-risk"><strong>{riskmetric}: Assessing Package Quality and Risk</strong></h2>
<p><img src="images/riskmetric.png" class="img-fluid" width="221"></p>
<p>The <a href="https://pharmar.github.io/riskmetric/articles/riskmetric.html"><strong>{riskmetric}</strong></a> package provides a framework to quantify the “risk” of R packages by assessing various metrics. Developed by the <a href="https://www.pharmar.org/"><strong>R Validation Hub</strong></a>, it helps organizations evaluate the quality and suitability of R packages for validated environments. The resulting risk is parameterized by the organization, which makes the decision on how to weigh the risk from the different metrics.</p>
<section id="features-of-riskmetric" class="level3">
<h3 class="anchored" data-anchor-id="features-of-riskmetric"><strong>Features of {riskmetric}</strong></h3>
<ul>
<li><p><a href="https://github.com/pharmaR/riskmetric/">{riskmetric}</a> <strong>evaluates R packages</strong> across several categories, including development best practices, code documentation, community engagement, and development sustainability.</p></li>
<li><p>The package is designed to be extensible, allowing users to define custom metrics or adapt existing ones to suit their specific requirements.</p></li>
<li><p><a href="https://pharmar.github.io/riskmetric/articles/riskmetric.html">{riskmetric}</a> includes functions for generating detailed reports and visualizations of the package risk assessment, facilitating informed decision-making.<br>
</p></li>
</ul>
</section>
<section id="example-code-2" class="level3">
<h3 class="anchored" data-anchor-id="example-code-2"><strong>Example Code</strong></h3>
<p>The following example demonstrates how to use the <a href="https://pharmar.github.io/riskmetric/articles/riskmetric.html">{riskmetric}</a> package to evaluate the risk of selected R packages. We start by loading the necessary libraries and using <a href="https://pharmar.github.io/riskmetric/articles/riskmetric.html">{riskmetric}</a> functions to assess and score the packages.</p>
<pre><code># Load necessary libraries
library(dplyr)
library(riskmetric)

# Assess and score R packages
pkg_ref(c("riskmetric", "utils", "tools")) %&gt;%
  pkg_assess() %&gt;%
  pkg_score()</code></pre>
<p><br>
<strong>Results</strong></p>
<p><img src="images/riskassessment-example.png" class="img-fluid"></p>
<p>It is closely related to <a href="https://github.com/pharmaR/riskassessment"><strong>{riskassessment}</strong></a> (the app’s main goal is to help those making “package inclusion” requests for validated GxP environments) and <a href="https://github.com/pharmaR/riskscore"><strong>{riskscore}</strong></a> (data package for cataloging riskmetric results across public repositories).&nbsp;<br>
</p>
<p><strong>More on Riskmetric</strong></p>
<ul>
<li><p><a href="https://youtu.be/L0ZZHPh2ec4">Using {riskassessment} for R Package Validation</a>&nbsp;</p></li>
<li><p><a href="https://www.pharmar.org/riskmetric/">The {riskmetric} Package</a>&nbsp;</p></li>
<li><p><a href="https://github.com/pharmaR/riskmetric">GitHub - pharmaR/riskmetric: Metrics to evaluate the risk of R packages</a>&nbsp;</p></li>
</ul>
</section>
</section>
<section id="tidycdisc-tidying-cdisc-data" class="level2">
<h2 class="anchored" data-anchor-id="tidycdisc-tidying-cdisc-data"><strong>TidyCDISC: Tidying CDISC Data</strong></h2>
<p><img src="images/tidyCDISC.png" class="img-fluid"></p>
<p><a href="https://github.com/Biogen-Inc/tidyCDISC/"><strong>{tidyCDISC}</strong></a> is an open-source R package developed by <a href="https://www.biogen.com/">Biogen</a> that provides a set of functions for tidying and manipulating <a href="https://www.cdisc.org/">CDISC</a> (Clinical Data Interchange Standards Consortium) datasets. It aims to simplify the process of working with <a href="https://www.cdisc.org/">CDISC</a> data by providing an intuitive interface for data transformation tasks and ensuring consistency with the principles of tidy data.</p>
<section id="features-of-tidycdisc" class="level3">
<h3 class="anchored" data-anchor-id="features-of-tidycdisc"><strong>Features of TidyCDISC</strong></h3>
<ol type="1">
<li><p><a href="https://github.com/Biogen-Inc/tidyCDISC/">{tidyCDISC}</a> <strong>adheres to the principles of tidy data</strong>, ensuring that CDISC datasets are structured in a consistent and easy-to-work-with format.</p></li>
<li><p>The package <strong>supports various CDISC datasets</strong>, including SDTM (Study Data Tabulation Model), ADaM (Analysis Data Model), and SEND (Standard for Exchange of Nonclinical Data).</p></li>
<li><p>It provides a set of <strong>functions for common data transformation tasks,</strong> such as converting between CDISC datasets, handling missing values, and applying CDISC-specific terminology.</p></li>
<li><p>The package includes <strong>functions for validating CDISC datasets</strong> and performing consistency checks across related datasets.</p></li>
<li><p><a href="https://github.com/Biogen-Inc/tidyCDISC/">{tidyCDISC}</a> is designed to <strong>work seamlessly with other <a href="https://pharmaverse.org/">pharmaverse</a> packages</strong>.</p></li>
</ol>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1"><strong>Example</strong></h3>
<p>Here’s a <a href="https://rinpharma.shinyapps.io/tidyCDISC/">demo version of {tidyCDISC}</a> you can try.</p>
<p><img src="images/tidycdisc-example.gif" class="img-fluid"></p>
<p>In the <a href="https://biogen-inc.github.io/tidyCDISC/articles/tidyCDISC.html">documentation</a>, you can find more examples of applications and how to use <a href="https://github.com/Biogen-Inc/tidyCDISC/">{tidyCDISC}</a>.<br>
</p>
<p><strong>More on tidyCDISC</strong></p>
<ul>
<li><p><a href="https://biogen-inc.github.io/tidyCDISC/articles/Blog.html">TidyCDISC blog</a></p></li>
<li><p><a href="https://www.youtube.com/@tidycdiscapp768">tidyCDISC YouTube channel</a></p></li>
</ul>
</section>
</section>
<section id="honorable-mention" class="level2">
<h2 class="anchored" data-anchor-id="honorable-mention"><strong>Honorable Mention 😀</strong></h2>
<section id="xportr-creating-cdisc-compliant-xpt-files-in-r" class="level3">
<h3 class="anchored" data-anchor-id="xportr-creating-cdisc-compliant-xpt-files-in-r"><strong>{xportr}: Creating CDISC-Compliant XPT Files in R</strong></h3>
<p><img src="images/xportr.png" class="img-fluid" width="184"></p>
<p>Finally, let’s look at <a href="https://github.com/atorus-research/xportr">{xportr}</a>, an open-source R package developed by <a href="https://www.gsk.com/en-gb/">GSK</a>, <a href="https://www.atorusresearch.com/">Atorus</a>, and <a href="https://appsilon.com/">Appsilon</a> that simplifies the process of creating <strong>CDISC-compliant XPT files</strong> directly from R. It serves as a valuable tool for clinical programmers working with ADaM or SDTM datasets.&nbsp;</p>
<p>This package ensures compatibility with regulatory submission requirements, providing a seamless bridge between R and traditional SAS-based workflows.&nbsp;</p>
<p><a href="https://github.com/atorus-research/xportr">{xportr}</a> is designed to handle the intricacies of the XPORT format, making it easier to share data across different platforms and with regulatory authorities. This capability is crucial for teams working in environments where both R and SAS are used, facilitating smooth and compliant data exchanges.</p>
<p><strong>Features of {xportr}</strong></p>
<ul>
<li><p><a href="https://github.com/atorus-research/xportr">{xportr}</a> provides <strong>functions to associate metadata information</strong> to an R data frame, apply appropriate types, lengths, labels, formats, and ordering, and then write out a CDISC-compliant XPT file.</p></li>
<li><p>Performs various <strong>checks on the datasets to ensure CDISC compliance</strong> before exporting to XPT format, including variable name formatting, character length limits, type coercion, and more.</p></li>
<li><p>Uses a well-defined <strong>specification file</strong> (e.g., ADaM_spec.xlsx) to apply metadata and formatting rules.</p></li>
<li><p><strong>Flexible API</strong> allows for the application of transformations individually or chained together in a pipeline.</p></li>
</ul>
<p>In summary, <a href="https://github.com/atorus-research/xportr">{xportr}</a> is a valuable tool for clinical programmers working with CDISC data, as it helps ensure regulatory compliance, data quality, and workflow efficiency when creating XPT files for clinical trials and submissions.</p>
<p><strong>More on xportr</strong></p>
<ul>
<li><p><a href="https://pharmaverse.github.io/blog/posts/2024-03-29_xportr_0_4_0/xportr_0_4_0.html">xportr 0.4.0</a></p></li>
<li><p><a href="https://atorus-research.github.io/xportr/">Utilities to Output CDISC SDTM/ADaM XPT Files • xportr</a>&nbsp;</p></li>
</ul>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion"><strong>Conclusion</strong></h2>
<p>The <a href="https://pharmaverse.org/">pharmaverse</a> offers a rich ecosystem of tools designed to streamline clinical research workflows, ensuring high-quality data management and reporting. By leveraging packages like <a href="https://github.com/insightsengineering/rtables">{rtables}</a>, <a href="https://github.com/pharmaverse/admiral/tree/main?tab=readme-ov-file">{admiral}</a>, <a href="https://github.com/insightsengineering/teal">{teal}</a>, <a href="https://github.com/pharmaR/riskmetric">{riskmetric}</a>, <a href="https://github.com/Biogen-Inc/tidyCDISC/">{tidyCDISC}</a>, and <a href="https://github.com/atorus-research/xportr/">{xportr}</a>, pharmaceutical companies can enhance their data analysis capabilities, ensure regulatory compliance, and drive innovation in clinical research. <strong>Remember to give the packages that you use and value a star on GitHub. ⭐</strong></p>
<blockquote class="blockquote">
<p>To receive the latest updates on what’s new in the pharmaverse, <a href="https://forms.office.com/e/AJu4xWEGJx">subscribe to the periodic newsletter!</a></p>
</blockquote>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{kenneth2024,
  author = {Kenneth, Gift and , APPSILON},
  title = {Exploring the {Top} 5 Pharmaverse {Packages}},
  date = {2024-08-15},
  url = {https://pharmaverse.github.io/blog/posts/2024-08-15_top_five_pharmaverse_packages/top-five-packages.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-kenneth2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Kenneth, Gift, and APPSILON. 2024. <span>“Exploring the Top 5
Pharmaverse Packages.”</span> August 15, 2024. <a href="https://pharmaverse.github.io/blog/posts/2024-08-15_top_five_pharmaverse_packages/top-five-packages.html">https://pharmaverse.github.io/blog/posts/2024-08-15_top_five_pharmaverse_packages/top-five-packages.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pharmaverse\.github\.io\/blog");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>